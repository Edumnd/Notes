# C语言指针

32位处理器，有2^32个内存单元，即4GB。4G是虚拟地址，不是实际的内存大小，因而你的32CPU可以插入一个2G的内存条。

同理，64位处理器有2^64个内存单元，即4G个4GB。这是虚拟地址，不是实际内存大小，实际内存大小可能是插入的8GB内存条，或是16GB内存。

当程序运行时，操作系统会为每个程序分配运行所需的实际内存地址空间，这就是动态```地址转换``` 的过程。

***因而在编程时所说的地址，指的是虚拟地址，即虚拟地址空间。***

#### 64位 VS 32位 处理器

- 当是64位处理器时（AMD，Intel）

  ```c++
  int i = 5;
  long j = long(&j);
  printf("%lx",j);
  //输出结果为：7ffee068f718
  //即只使用了48位虚拟地址，48位虚拟地址相当于256TB
  //但是
  printf("%ld",&i);
  //输出结果为8，即指针变量为8个字节
  ```

  

- 当是32位处理器时，地址空间应该是0x00000001~0xFFFFFFFF，其中0x00000000保留位系统0。64位处理器，也可以通过兼容模式，来编写32位程序。

#### 小端模式与栈空间

以64位处理器(48位实际被利用)为例

```c++
int i = 5;
int j = 9;
printf("%lx\n",long(pi));
printf("%lx\n", long(pj));
/*输出结果为	 7ffee990b718 和 7ffee990b714
说明：
1. int占4个字节 
2.i先定义，j后定义，但是i的地址比j地址大，
则栈空间向低地址方向增长*/

long t = long(pi);
printf("%d\n",*((int *)t)); //将t强转化成int*，然后解引用
// 输出5
t++;
printf("%d\n",*((int *)t)); 
// 输出0
/*说明：
小端模式，即变量的高字节在虚拟内存的低地址空间存储。
*/
```

因而，若一个变量int i=5的地址为0x003a58fe（32位），他有指针变量int * p = &i，则p中存储的值为fe 58 3a 00。

### 虚拟内存地址空间

程序的虚拟地址空间有如下图结构

<div align="middle">
<img src="./images/image003.gif" align="middle">
</div>

- .text，即正文段存储可执行程序的二进制代码。
- .data，即数据段存储程序执行时的常量。
- stack，heap增长方向相反。

#### 定义指针

连续定义指针时**注意**

```c++
int a, b; //定义两个整型变量
int *p,q; //注意～～～～～p是整型指针，q是整型变量
//应该定义成
int *p, *q;
```



 

 

 

 